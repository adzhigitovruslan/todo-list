const iconSun=document.querySelector(".todo__icon-day"),iconNight=document.querySelector(".todo__icon-night"),dayPic=document.querySelector(".page__background-day"),nightPic=document.querySelector(".page__background-night");function changeIcon(){setTimeout((t=>{iconSun.classList.toggle("active")}),1),setTimeout((t=>{iconNight.classList.toggle("active")}),1),document.body.classList.toggle("active"),dayPic.classList.toggle("active"),nightPic.classList.toggle("active"),document.body.classList.contains("active")?(localStorage.setItem("theme","active"),localStorage.setItem("iconNight","active")):(localStorage.removeItem("theme"),localStorage.removeItem("iconNight"))}document.querySelector(".todo__icon").addEventListener("click",changeIcon);const buttonsTabs=document.querySelectorAll(".todo__options-text");let storedTab=localStorage.getItem("selectedTab")||"[]",tabIndex=JSON.parse(storedTab);for(const t of tabIndex)buttonsTabs[t].classList.add("active");function saveSelectedTab(){const t=[];for(let e=0;e<buttonsTabs.length;e++)buttonsTabs[e].classList.contains("active")&&t.push(e);localStorage.setItem("selectedTab",JSON.stringify(t))}buttonsTabs.forEach((function(t){t.addEventListener("click",(function(){buttonsTabs.forEach((function(t){t.classList.remove("active")})),t.classList.add("active")}))}));const todoButton=document.querySelector("#add-button"),todoList=document.querySelector(".todo__list"),todoInput=document.querySelector(".todo__input"),filterOption=document.querySelectorAll(".todo__view-options"),todoClear=document.querySelector(".todo__clear"),todoListItem=document.querySelector(".todo__list-item"),draggables=document.querySelector(".todo__list").childNodes,checkButtons=document.querySelector(".todo__list").children,modeButtons=document.querySelector("[class=todo__view-options]");function createListElementByButton(t){t.preventDefault();const e=document.createElement("li");e.classList.add("todo__item"),e.setAttribute("draggable","true");const o=document.createElement("input");o.classList.add("todo__checkbox"),o.setAttribute("type","checkbox"),o.setAttribute("id",todoInput.value);const c=document.createElement("label");c.classList.add("todo__input-label"),c.setAttribute("for",todoInput.value);const n=document.createElement("label");n.classList.add("todo__list-item"),n.setAttribute("for",todoInput.value);const s=document.createElement("button");s.innerHTML='<i class="_icon-close"></i>',s.classList.add("todo__close");const a=todoInput.value;a&&(saveItemsToLocalStorageList(a,o),n.append(a),e.append(o,c,n,s),todoList.appendChild(e),todoInput.value="",dragAndDrop(),checkAmounOfDiv())}function getItemsFromLocalStorage(){getDarkMode(),localStorage.getItem("item-left")?document.querySelector("#items").textContent=JSON.parse(localStorage.getItem("item-left"))+" items left":document.querySelector("#items").textContent="0 items left";const t=JSON.parse(localStorage.getItem("listElements"));null!==t&&t.forEach((t=>{const e=document.createElement("input");e.classList.add("todo__checkbox"),e.setAttribute("type","checkbox"),e.setAttribute("id",t.itemValue),t.inputCheckState&&e.setAttribute("checked",t.inputCheckState);const o=document.createElement("li");o.classList.add("todo__item"),o.setAttribute("draggable","true");const c=document.createElement("label");c.classList.add("todo__input-label"),c.setAttribute("for",t.itemValue);const n=document.createElement("label");n.classList.add("todo__list-item"),n.setAttribute("for",t.itemValue);const s=document.createElement("button");s.innerHTML='<i class="_icon-close"></i>',s.classList.add("todo__close"),n.append(t.itemValue),o.append(e,c,n,s),todoList.appendChild(o),todoInput.value="",dragAndDrop()}));document.querySelectorAll(".todo__checkbox").forEach((t=>{t.checked?t.parentElement.classList.add("completed"):t.parentElement.classList.remove("completed")})),null===localStorage.getItem("selectedTab")&&buttonControl[0].click(),clickOnActive()}function saveItemsToLocalStorageList(t,e){let o;o=null===localStorage.getItem("listElements")?[]:JSON.parse(localStorage.getItem("listElements")),o.push({itemValue:t,inputCheckState:e.checked}),localStorage.setItem("listElements",JSON.stringify(o))}function removeAllLocal(){document.querySelectorAll(".todo__item.completed").forEach((t=>{t.remove()}));const t=JSON.parse(localStorage.getItem("listElements")).filter((t=>!1===t.inputCheckState));localStorage.setItem("listElements",JSON.stringify(t))}function deleteElementsFromList(t){const e=t.target,o=e.parentElement.textContent;if("todo__close"===e.className){const t=JSON.parse(localStorage.getItem("listElements"));t.forEach((e=>{if(e.itemValue===o){const o=t.indexOf(e);t.splice(o,1),localStorage.setItem("listElements",JSON.stringify(t))}})),e.parentElement.remove();const c=e.parentElement;c.classList.add("fall"),c.addEventListener("transitionend",(function(){c.remove()})),checkAmounOfDiv()}else if("todo__input-label"===e.className){e.parentElement.classList.toggle("completed"),checkAmounOfDiv()}dragAndDrop()}function checkAmounOfDiv(){const t=document.querySelectorAll(".todo__item.completed"),e=todoList.children.length-t.length;document.querySelector("#items").textContent=e+" items left",localStorage.setItem("item-left",JSON.stringify(e))}function changeCheckboxState(t){if("checkbox"===t.target.type){const e=JSON.parse(localStorage.getItem("listElements"));e.forEach((e=>{e.itemValue===t.target.id&&(e.inputCheckState=!1===e.inputCheckState)})),localStorage.setItem("listElements",JSON.stringify(e))}}function filterTodo(t){Array.from(todoList.children).forEach((function(e){switch(t.target.dataset.show){case"all":e.style.display="flex";break;case"completed":e.classList.contains("completed")?e.style.display="flex":e.style.display="none";break;case"active":e.classList.contains("completed")?e.style.display="none":e.style.display="flex"}}))}function dragAndDrop(){Array.from(draggables).forEach((t=>{t.addEventListener("dragstart",(()=>{t.classList.add("dragging")})),t.addEventListener("dragend",(()=>{t.classList.remove("dragging")}))})),todoList.addEventListener("dragover",(t=>{t.preventDefault();const e=getDragAfterElement(todoList,t.clientY),o=document.querySelector(".dragging");null==e?todoList.appendChild(o):todoList.insertBefore(o,e)}))}function getDragAfterElement(t,e){return[...t.querySelectorAll(".todo__item:not(.dragging)")].reduce(((t,o)=>{const c=o.getBoundingClientRect(),n=e-c.top-c.height/2;return n<0&&n>t.offset?{offset:n,element:o}:t}),{offset:Number.NEGATIVE_INFINITY}).element}function getDarkMode(){"active"===localStorage.theme?(document.body.classList.add("active"),iconSun.classList.remove("active"),dayPic.classList.add("active"),iconNight.classList.add("active"),nightPic.classList.add("active")):(document.body.classList.remove("active"),dayPic.classList.remove("active"),nightPic.classList.remove("active"),iconNight.classList.remove("active"),iconSun.classList.add("active"))}function clickOnActive(){for(i=0;i<buttonsTabs.length;i++)buttonsTabs[i].classList.contains("active")&&buttonsTabs[i].click()}document.addEventListener("DOMContentLoaded",getItemsFromLocalStorage),todoButton.addEventListener("click",createListElementByButton),todoList.addEventListener("click",deleteElementsFromList),todoList.addEventListener("click",changeCheckboxState),todoClear.addEventListener("click",removeAllLocal),window.onresize=clickOnActive,filterOption.forEach((t=>{t.addEventListener("click",filterTodo),t.addEventListener("click",saveSelectedTab)}));